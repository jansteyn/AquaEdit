<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:AquaEdit.UI.Avalonia.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="80"
             x:Class="AquaEdit.UI.Avalonia.Views.SearchView"
             x:DataType="vm:SearchViewModel">
  
  <Design.DataContext>
    <vm:SearchViewModel />
  </Design.DataContext>

  <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto" Margin="8">
    <!-- Search Input Row -->
    <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" 
                Orientation="Horizontal" Spacing="8">
      
      <!-- Search Box -->
      <TextBox Name="SearchTextBox"
               Text="{Binding SearchText}"
               Watermark="Find..."
               MinWidth="300"
               VerticalAlignment="Center">
        <TextBox.InnerLeftContent>
          <PathIcon Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
                    Width="16" Height="16"
                    Margin="8,0,0,0" />
        </TextBox.InnerLeftContent>
      </TextBox>

      <!-- Previous Button -->
      <Button Command="{Binding FindPreviousCommand}"
              ToolTip.Tip="Find Previous (Shift+F3)"
              Padding="8">
        <PathIcon Data="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" 
                  Width="16" Height="16" />
      </Button>

      <!-- Next Button -->
      <Button Command="{Binding FindNextCommand}"
              ToolTip.Tip="Find Next (F3)"
              Padding="8">
        <PathIcon Data="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" 
                  Width="16" Height="16" />
      </Button>

      <!-- Find All Button -->
      <Button Command="{Binding FindAllCommand}"
              Content="Find All"
              ToolTip.Tip="Find All Occurrences" />

      <!-- Options -->
      <Separator Width="1" Height="24" />

      <CheckBox IsChecked="{Binding CaseSensitive}"
                Content="Aa"
                ToolTip.Tip="Match Case" />

      <CheckBox IsChecked="{Binding UseRegex}"
                Content=".*"
                ToolTip.Tip="Use Regular Expression"
                FontFamily="Consolas,Courier New,monospace" />

      <!-- Status -->
      <TextBlock Text="{Binding SearchStatus}"
                 VerticalAlignment="Center"
                 Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                 Margin="16,0,0,0" />

      <!-- Loading Spinner -->
      <ProgressBar IsIndeterminate="True"
                   IsVisible="{Binding IsSearching}"
                   Width="100"
                   Height="4"
                   VerticalAlignment="Center" />

      <!-- Cancel Button -->
      <Button Command="{Binding CancelSearchCommand}"
              IsVisible="{Binding IsSearching}"
              Content="Cancel"
              ToolTip.Tip="Cancel Search" />
    </StackPanel>

    <!-- Replace Row -->
    <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3"
                Orientation="Horizontal" Spacing="8"
                Margin="0,8,0,0">
      
      <!-- Replace Box -->
      <TextBox Text="{Binding ReplaceText}"
               Watermark="Replace..."
               MinWidth="300"
               VerticalAlignment="Center">
        <TextBox.InnerLeftContent>
          <PathIcon Data="M14.06,9L15,9.94L5.92,19H5V18.08L14.06,9M17.66,3C17.41,3 17.15,3.1 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18.17,3.09 17.92,3 17.66,3M14.06,6.19L3,17.25V21H6.75L17.81,9.94L14.06,6.19Z"
                    Width="16" Height="16"
                    Margin="8,0,0,0" />
        </TextBox.InnerLeftContent>
      </TextBox>

      <!-- Replace Button -->
      <Button Command="{Binding ReplaceCommand}"
              Content="Replace"
              ToolTip.Tip="Replace Current Match" />

      <!-- Replace All Button -->
      <Button Command="{Binding ReplaceAllCommand}"
              Content="Replace All"
              ToolTip.Tip="Replace All Matches" />
    </StackPanel>
  </Grid>
</UserControl>